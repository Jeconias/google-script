!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Books=e()}(function(){return function r(i,a,l){function o(t,e){if(!a[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=a[t]={exports:{}},i[t][0].call(n.exports,function(e){return o(i[t][1][e]||e)},n,n.exports,r,i,a,l)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)o(l[e]);return o}({1:[function(e,t,r){},{}],2:[function(e,t,r){"use strict";var o=e("get-intrinsic"),n=e("./"),i=n(o("String.prototype.indexOf"));t.exports=function callBoundIntrinsic(e,t){t=o(e,!!t);return"function"==typeof t&&-1<i(e,".prototype.")?n(t):t}},{"./":3,"get-intrinsic":7}],3:[function(t,e,r){"use strict";var o=t("function-bind"),n=t("get-intrinsic"),i=t("set-function-length"),a=n("%TypeError%"),l=n("%Function.prototype.apply%"),c=n("%Function.prototype.call%"),p=n("%Reflect.apply%",!0)||o.call(c,l),t=n("%Object.defineProperty%",!0),u=n("%Math.max%");if(t)try{t({},"a",{value:1})}catch(e){t=null}e.exports=function callBind(e){if("function"!=typeof e)throw new a("a function is required");var t=p(o,c,arguments);return i(t,1+u(0,e.length-(arguments.length-1)),!0)};n=function applyBind(){return p(o,l,arguments)};t?t(e.exports,"apply",{value:n}):e.exports.apply=n},{"function-bind":6,"get-intrinsic":7,"set-function-length":20}],4:[function(e,t,r){"use strict";var o=e("has-property-descriptors")(),n=e("get-intrinsic"),c=o&&n("%Object.defineProperty%",!0);if(c)try{c({},"a",{value:1})}catch(e){c=!1}var p=n("%SyntaxError%"),u=n("%TypeError%"),s=e("gopd");t.exports=function defineDataProperty(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new u("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new u("`property` must be a string or a symbol`");if(3<arguments.length&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new u("`nonEnumerable`, if provided, must be a boolean or null");if(4<arguments.length&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new u("`nonWritable`, if provided, must be a boolean or null");if(5<arguments.length&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new u("`nonConfigurable`, if provided, must be a boolean or null");if(6<arguments.length&&"boolean"!=typeof arguments[6])throw new u("`loose`, if provided, must be a boolean");var o=3<arguments.length?arguments[3]:null,n=4<arguments.length?arguments[4]:null,i=5<arguments.length?arguments[5]:null,a=6<arguments.length&&arguments[6],l=!!s&&s(e,t);if(c)c(e,t,{configurable:null===i&&l?l.configurable:!i,enumerable:null===o&&l?l.enumerable:!o,value:r,writable:null===n&&l?l.writable:!n});else{if(!a&&(o||n||i))throw new p("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r}}},{"get-intrinsic":7,gopd:8,"has-property-descriptors":9}],5:[function(e,t,r){"use strict";var c=Object.prototype.toString,p=Math.max,u=function concatty(e,t){for(var r=[],o=0;o<e.length;o+=1)r[o]=e[o];for(var n=0;n<t.length;n+=1)r[n+e.length]=t[n];return r},s=function slicy(e,t){for(var r=[],o=t||0,n=0;o<e.length;o+=1,n+=1)r[n]=e[o];return r};t.exports=function bind(t){var r=this;if("function"!=typeof r||"[object Function]"!==c.apply(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var o,e,n=s(arguments,1),i=p(0,r.length-n.length),a=[],l=0;l<i;l++)a[l]="$"+l;return o=Function("binder","return function ("+function(e,t){for(var r="",o=0;o<e.length;o+=1)r+=e[o],o+1<e.length&&(r+=t);return r}(a,",")+"){ return binder.apply(this,arguments); }")(function(){var e;return this instanceof o?(e=r.apply(this,u(n,arguments)),Object(e)===e?e:this):r.apply(t,u(n,arguments))}),r.prototype&&((e=function Empty(){}).prototype=r.prototype,o.prototype=new e,e.prototype=null),o}},{}],6:[function(e,t,r){"use strict";e=e("./implementation");t.exports=Function.prototype.bind||e},{"./implementation":5}],7:[function(e,t,r){"use strict";var o,f=SyntaxError,n=Function,y=TypeError,i=function(e){try{return n('"use strict"; return ('+e+").constructor;")()}catch(e){}},d=Object.getOwnPropertyDescriptor;if(d)try{d({},"")}catch(e){d=null}function e0(){throw new y}var a=d?function(){try{return e0}catch(e){try{return d(arguments,"callee").get}catch(e){return e0}}}():e0,l=e("has-symbols")(),c=e("has-proto")(),p=Object.getPrototypeOf||(c?function(e){return e.__proto__}:null),u={},c="undefined"!=typeof Uint8Array&&p?p(Uint8Array):o,g={"%AggregateError%":"undefined"==typeof AggregateError?o:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?o:ArrayBuffer,"%ArrayIteratorPrototype%":l&&p?p([][Symbol.iterator]()):o,"%AsyncFromSyncIteratorPrototype%":o,"%AsyncFunction%":u,"%AsyncGenerator%":u,"%AsyncGeneratorFunction%":u,"%AsyncIteratorPrototype%":u,"%Atomics%":"undefined"==typeof Atomics?o:Atomics,"%BigInt%":"undefined"==typeof BigInt?o:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?o:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?o:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?o:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?o:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?o:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?o:FinalizationRegistry,"%Function%":n,"%GeneratorFunction%":u,"%Int8Array%":"undefined"==typeof Int8Array?o:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?o:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?o:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":l&&p?p(p([][Symbol.iterator]())):o,"%JSON%":"object"==typeof JSON?JSON:o,"%Map%":"undefined"==typeof Map?o:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&l&&p?p((new Map)[Symbol.iterator]()):o,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?o:Promise,"%Proxy%":"undefined"==typeof Proxy?o:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?o:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?o:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&l&&p?p((new Set)[Symbol.iterator]()):o,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?o:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":l&&p?p(""[Symbol.iterator]()):o,"%Symbol%":l?Symbol:o,"%SyntaxError%":f,"%ThrowTypeError%":a,"%TypedArray%":c,"%TypeError%":y,"%Uint8Array%":"undefined"==typeof Uint8Array?o:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?o:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?o:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?o:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?o:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?o:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?o:WeakSet};if(p)try{null.error}catch(e){l=p(p(e));g["%Error.prototype%"]=l}var s=function doEval(e){var t,r;return"%AsyncFunction%"===e?t=i("async function () {}"):"%GeneratorFunction%"===e?t=i("function* () {}"):"%AsyncGeneratorFunction%"===e?t=i("async function* () {}"):"%AsyncGenerator%"===e?(r=doEval("%AsyncGeneratorFunction%"))&&(t=r.prototype):"%AsyncIteratorPrototype%"===e&&(r=doEval("%AsyncGenerator%"))&&p&&(t=p(r.prototype)),g[e]=t},b={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},a=e("function-bind"),h=e("hasown"),m=a.call(Function.call,Array.prototype.concat),v=a.call(Function.apply,Array.prototype.splice),S=a.call(Function.call,String.prototype.replace),w=a.call(Function.call,String.prototype.slice),j=a.call(Function.call,RegExp.prototype.exec),O=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,P=/\\(\\)?/g,A=function stringToPath(e){var t=w(e,0,1),r=w(e,-1);if("%"===t&&"%"!==r)throw new f("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new f("invalid intrinsic syntax, expected opening `%`");var n=[];return S(e,O,function(e,t,r,o){n[n.length]=r?S(o,P,"$1"):t||e}),n},x=function getBaseIntrinsic(e,t){var r,o=e;if(h(b,o)&&(o="%"+(r=b[o])[0]+"%"),h(g,o)){var n=g[o];if(void 0!==(n=n===u?s(o):n)||t)return{alias:r,name:o,value:n};throw new y("intrinsic "+e+" exists, but is not available. Please file an issue!")}throw new f("intrinsic "+e+" does not exist!")};t.exports=function GetIntrinsic(e,t){if("string"!=typeof e||0===e.length)throw new y("intrinsic name must be a non-empty string");if(1<arguments.length&&"boolean"!=typeof t)throw new y('"allowMissing" argument must be a boolean');if(null===j(/^%?[^%]*%?$/,e))throw new f("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=A(e),o=0<r.length?r[0]:"",n=x("%"+o+"%",t),i=(n.name,n.value),a=!1,n=n.alias;n&&(o=n[0],v(r,m([0,1],n)));for(var l=1,c=!0;l<r.length;l+=1){var p=r[l],u=w(p,0,1),s=w(p,-1);if(('"'===u||"'"===u||"`"===u||'"'===s||"'"===s||"`"===s)&&u!==s)throw new f("property names with quotes must have matching quotes");if("constructor"!==p&&c||(a=!0),h(g,u="%"+(o+="."+p)+"%"))i=g[u];else if(null!=i){if(!(p in i)){if(t)return;throw new y("base intrinsic for "+e+" exists, but the property is not available.")}i=d&&l+1>=r.length?(c=!!(s=d(i,p)))&&"get"in s&&!("originalValue"in s.get)?s.get:i[p]:(c=h(i,p),i[p]),c&&!a&&(g[u]=i)}}return i}},{"function-bind":6,"has-proto":10,"has-symbols":11,hasown:13}],8:[function(t,e,r){"use strict";t=t("get-intrinsic")("%Object.getOwnPropertyDescriptor%",!0);if(t)try{t([],"length")}catch(e){t=null}e.exports=t},{"get-intrinsic":7}],9:[function(e,t,r){"use strict";var o=e("get-intrinsic")("%Object.defineProperty%",!0),n=function hasPropertyDescriptors(){if(o)try{return o({},"a",{value:1}),!0}catch(e){}return!1};n.hasArrayLengthDefineBug=function hasArrayLengthDefineBug(){if(!n())return null;try{return 1!==o([],"length",{value:1}).length}catch(e){return!0}},t.exports=n},{"get-intrinsic":7}],10:[function(e,t,r){"use strict";var o={foo:{}},n=Object;t.exports=function hasProto(){return{__proto__:o}.foo===o.foo&&!({__proto__:null}instanceof n)}},{}],11:[function(e,t,r){"use strict";var o="undefined"!=typeof Symbol&&Symbol,n=e("./shams");t.exports=function hasNativeSymbols(){return"function"==typeof o&&"function"==typeof Symbol&&"symbol"==typeof o("foo")&&"symbol"==typeof Symbol("bar")&&n()}},{"./shams":12}],12:[function(e,t,r){"use strict";t.exports=function hasSymbols(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"!=typeof Symbol.iterator){var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){r=Object.getOwnPropertyDescriptor(e,t);if(42!==r.value||!0!==r.enumerable)return!1}}return!0}},{}],13:[function(e,t,r){"use strict";var o=Function.prototype.call,n=Object.prototype.hasOwnProperty,e=e("function-bind");t.exports=e.call(o,n)},{"function-bind":6}],14:[function(a,l,e){!function(U){!function(){var e="function"==typeof Map&&Map.prototype,t=Object.getOwnPropertyDescriptor&&e?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,d=e&&t&&"function"==typeof t.get?t.get:null,g=e&&Map.prototype.forEach,t="function"==typeof Set&&Set.prototype,e=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,b=t&&e&&"function"==typeof e.get?e.get:null,h=t&&Set.prototype.forEach,m="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,v="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,S="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,F=Boolean.prototype.valueOf,r=Object.prototype.toString,N=Function.prototype.toString,D=String.prototype.match,w=String.prototype.slice,j=String.prototype.replace,o=String.prototype.toUpperCase,O=String.prototype.toLowerCase,u=RegExp.prototype.test,P=Array.prototype.concat,A=Array.prototype.join,T=Array.prototype.slice,n=Math.floor,x="function"==typeof BigInt?BigInt.prototype.valueOf:null,s=Object.getOwnPropertySymbols,E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,_="function"==typeof Symbol&&"object"==typeof Symbol.iterator,k="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,R=Object.prototype.propertyIsEnumerable,I=("function"==typeof Reflect?Reflect:Object).getPrototypeOf||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function addNumericSeparator(e,t){if(e===1/0||e===-1/0||e!=e||e&&-1e3<e&&e<1e3||u.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var o=e<0?-n(-e):n(e);if(o!==e)return e=String(o),o=w.call(t,e.length+1),j.call(e,r,"$&_")+"."+j.call(j.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}return j.call(t,r,"$&_")}var B=a("./util.inspect"),e=B.custom,M=isSymbol(e)?e:null;function wrapQuotes(e,t,r){r="double"===(r.quoteStyle||t)?'"':"'";return r+e+r}function isArray(e){return!("[object Array]"!==toStr(e)||k&&"object"==typeof e&&k in e)}function isRegExp(e){return!("[object RegExp]"!==toStr(e)||k&&"object"==typeof e&&k in e)}function isSymbol(e){if(_)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return 1;if(e&&"object"==typeof e&&E)try{return E.call(e),1}catch(e){}}l.exports=function inspect_(r,e,o,n){var i=e||{};if(has(i,"quoteStyle")&&"single"!==i.quoteStyle&&"double"!==i.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(has(i,"maxStringLength")&&("number"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');e=!has(i,"customInspect")||i.customInspect;if("boolean"!=typeof e&&"symbol"!==e)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(has(i,"indent")&&null!==i.indent&&"\t"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&0<i.indent))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(has(i,"numericSeparator")&&"boolean"!=typeof i.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var t=i.numericSeparator;if(void 0===r)return"undefined";if(null===r)return"null";if("boolean"==typeof r)return r?"true":"false";if("string"==typeof r)return function inspectString(e,t){if(e.length>t.maxStringLength)return r=e.length-t.maxStringLength,r="... "+r+" more character"+(1<r?"s":""),inspectString(w.call(e,0,t.maxStringLength),t)+r;var r=j.call(j.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,lowbyte);return wrapQuotes(r,"single",t)}(r,i);if("number"==typeof r)return 0===r?0<1/0/r?"0":"-0":(u=String(r),t?addNumericSeparator(r,u):u);if("bigint"==typeof r)return u=String(r)+"n",t?addNumericSeparator(r,u):u;t=void 0===i.depth?5:i.depth;if(t<=(o=void 0===o?0:o)&&0<t&&"object"==typeof r)return isArray(r)?"[Array]":"[Object]";var a,l,c,p,u=function getIndent(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&0<e.indent))return null;r=A.call(Array(e.indent+1)," ")}return{base:r,prev:A.call(Array(t+1),r)}}(i,o);if(void 0===n)n=[];else if(0<=indexOf(n,r))return"[Circular]";function inspect(e,t,r){return t&&(n=T.call(n)).push(t),r?(t={depth:i.depth},has(i,"quoteStyle")&&(t.quoteStyle=i.quoteStyle),inspect_(e,t,o+1,n)):inspect_(e,i,o+1,n)}if("function"==typeof r&&!isRegExp(r))return"[Function"+((c=function nameOf(e){if(e.name)return e.name;e=D.call(N.call(e),/^function\s*([\w$]+)/);if(e)return e[1];return null}(r))?": "+c:" (anonymous)")+"]"+(0<(c=arrObjKeys(r,inspect)).length?" { "+A.call(c,", ")+" }":"");if(isSymbol(r))return c=_?j.call(String(r),/^(Symbol\(.*\))_[^)]*$/,"$1"):E.call(r),"object"!=typeof r||_?c:markBoxed(c);if(function isElement(e){if(!e||"object"!=typeof e)return;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return 1;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(r)){for(var s="<"+O.call(String(r.nodeName)),f=r.attributes||[],y=0;y<f.length;y++)s+=" "+f[y].name+"="+wrapQuotes(function quote(e){return j.call(String(e),/"/g,"&quot;")}(f[y].value),"double",i);return s+=">",r.childNodes&&r.childNodes.length&&(s+="..."),s+="</"+O.call(String(r.nodeName))+">"}if(isArray(r))return 0===r.length?"[]":(c=arrObjKeys(r,inspect),u&&!function singleLineValues(e){for(var t=0;t<e.length;t++)if(0<=indexOf(e[t],"\n"))return;return 1}(c)?"["+indentedJoin(c,u)+"]":"[ "+A.call(c,", ")+" ]");if(function isError(e){return!("[object Error]"!==toStr(e)||k&&"object"==typeof e&&k in e)}(r))return c=arrObjKeys(r,inspect),"cause"in Error.prototype||!("cause"in r)||R.call(r,"cause")?0===c.length?"["+String(r)+"]":"{ ["+String(r)+"] "+A.call(c,", ")+" }":"{ ["+String(r)+"] "+A.call(P.call("[cause]: "+inspect(r.cause),c),", ")+" }";if("object"==typeof r&&e){if(M&&"function"==typeof r[M]&&B)return B(r,{depth:t-o});if("symbol"!==e&&"function"==typeof r.inspect)return r.inspect()}return function isMap(e){if(d&&e&&"object"==typeof e)try{d.call(e);try{b.call(e)}catch(e){return 1}return e instanceof Map}catch(e){}return}(r)?(a=[],g&&g.call(r,function(e,t){a.push(inspect(t,r,!0)+" => "+inspect(e,r))}),collectionOf("Map",d.call(r),a,u)):function isSet(e){if(b&&e&&"object"==typeof e)try{b.call(e);try{d.call(e)}catch(e){return 1}return e instanceof Set}catch(e){}return}(r)?(l=[],h&&h.call(r,function(e){l.push(inspect(e,r))}),collectionOf("Set",b.call(r),l,u)):function isWeakMap(e){if(m&&e&&"object"==typeof e)try{m.call(e,m);try{v.call(e,v)}catch(e){return 1}return e instanceof WeakMap}catch(e){}return}(r)?"WeakMap { ? }":function isWeakSet(e){if(v&&e&&"object"==typeof e)try{v.call(e,v);try{m.call(e,m)}catch(e){return 1}return e instanceof WeakSet}catch(e){}return}(r)?"WeakSet { ? }":function isWeakRef(e){if(S&&e&&"object"==typeof e)try{return S.call(e),1}catch(e){}return}(r)?"WeakRef { ? }":function isNumber(e){return!("[object Number]"!==toStr(e)||k&&"object"==typeof e&&k in e)}(r)?markBoxed(inspect(Number(r))):function isBigInt(e){if(e&&"object"==typeof e&&x)try{return x.call(e),1}catch(e){}return}(r)?markBoxed(inspect(x.call(r))):function isBoolean(e){return!("[object Boolean]"!==toStr(e)||k&&"object"==typeof e&&k in e)}(r)?markBoxed(F.call(r)):function isString(e){return!("[object String]"!==toStr(e)||k&&"object"==typeof e&&k in e)}(r)?markBoxed(inspect(String(r))):"undefined"!=typeof window&&r===window?"{ [object Window] }":r===U?"{ [object globalThis] }":function isDate(e){return!("[object Date]"!==toStr(e)||k&&"object"==typeof e&&k in e)}(r)||isRegExp(r)?String(r):(c=arrObjKeys(r,inspect),t=I?I(r)===Object.prototype:r instanceof Object||r.constructor===Object,e=r instanceof Object?"":"null prototype",p=!t&&k&&Object(r)===r&&k in r?w.call(toStr(r),8,-1):e?"Object":"",t=(!t&&"function"==typeof r.constructor&&r.constructor.name?r.constructor.name+" ":"")+(p||e?"["+A.call(P.call([],p||[],e||[]),": ")+"] ":""),0===c.length?t+"{}":u?t+"{"+indentedJoin(c,u)+"}":t+"{ "+A.call(c,", ")+" }")};var i=Object.prototype.hasOwnProperty||function(e){return e in this};function has(e,t){return i.call(e,t)}function toStr(e){return r.call(e)}function indexOf(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,o=e.length;r<o;r++)if(e[r]===t)return r;return-1}function lowbyte(e){var e=e.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+o.call(e.toString(16))}function markBoxed(e){return"Object("+e+")"}function collectionOf(e,t,r,o){return e+" ("+t+") {"+(o?indentedJoin(r,o):A.call(r,", "))+"}"}function indentedJoin(e,t){var r;return 0===e.length?"":(r="\n"+t.prev+t.base)+A.call(e,","+r)+"\n"+t.prev}function arrObjKeys(e,t){var r=isArray(e),o=[];if(r){o.length=e.length;for(var n=0;n<e.length;n++)o[n]=has(e,n)?t(e[n],e):""}var i,a="function"==typeof s?s(e):[];if(_)for(var l={},c=0;c<a.length;c++)l["$"+a[c]]=a[c];for(i in e)!has(e,i)||r&&String(Number(i))===i&&i<e.length||_&&l["$"+i]instanceof Symbol||(u.call(/[^\w$]/,i)?o.push(t(i,e)+": "+t(e[i],e)):o.push(i+": "+t(e[i],e)));if("function"==typeof s)for(var p=0;p<a.length;p++)R.call(e,a[p])&&o.push("["+t(a[p])+"]: "+t(e[a[p]],e));return o}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util.inspect":1}],15:[function(e,t,r){"use strict";var o=String.prototype.replace,n=/%20/g,i="RFC1738",a="RFC3986";t.exports={default:a,formatters:{RFC1738:function(e){return o.call(e,n,"+")},RFC3986:function(e){return String(e)}},RFC1738:i,RFC3986:a}},{}],16:[function(e,t,r){"use strict";var o=e("./stringify"),n=e("./parse"),e=e("./formats");t.exports={formats:e,parse:n,stringify:o}},{"./formats":15,"./parse":17,"./stringify":18}],17:[function(e,t,r){"use strict";var s=e("./utils"),h=Object.prototype.hasOwnProperty,f=Array.isArray,y={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:s.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},m=function(e,t){return e&&"string"==typeof e&&t.comma&&-1<e.indexOf(",")?e.split(","):e},c=function parseQueryStringValues(e,t){var r,o,n,i,a={__proto__:null},e=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,l=t.parameterLimit===1/0?void 0:t.parameterLimit,c=e.split(t.delimiter,l),p=-1,u=t.charset;if(t.charsetSentinel)for(r=0;r<c.length;++r)0===c[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===c[r]?u="utf-8":"utf8=%26%2310003%3B"===c[r]&&(u="iso-8859-1"),p=r,r=c.length);for(r=0;r<c.length;++r)r!==p&&(i=-1===(i=(o=c[r]).indexOf("]="))?o.indexOf("="):i+1,(i=-1===i?(n=t.decoder(o,y.decoder,u,"key"),t.strictNullHandling?null:""):(n=t.decoder(o.slice(0,i),y.decoder,u,"key"),s.maybeMap(m(o.slice(i+1),t),function(e){return t.decoder(e,y.decoder,u,"value")})))&&t.interpretNumericEntities&&"iso-8859-1"===u&&(i=i.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})),-1<o.indexOf("[]=")&&(i=f(i)?[i]:i),h.call(a,n)?a[n]=s.combine(a[n],i):a[n]=i);return a},p=function parseQueryStringKeys(e,t,r,o){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/g,a=0<r.depth&&/(\[[^[\]]*])/.exec(n),e=a?n.slice(0,a.index):n,l=[];if(e){if(!r.plainObjects&&h.call(Object.prototype,e)&&!r.allowPrototypes)return;l.push(e)}for(var c=0;0<r.depth&&null!==(a=i.exec(n))&&c<r.depth;){if(c+=1,!r.plainObjects&&h.call(Object.prototype,a[1].slice(1,-1))&&!r.allowPrototypes)return;l.push(a[1])}a&&l.push("["+n.slice(a.index)+"]");for(var p=l,e=t,u=r,s=o?e:m(e,u),f=p.length-1;0<=f;--f){var y,d,g,b=p[f];"[]"===b&&u.parseArrays?y=[].concat(s):(y=u.plainObjects?Object.create(null):{},d="["===b.charAt(0)&&"]"===b.charAt(b.length-1)?b.slice(1,-1):b,g=parseInt(d,10),u.parseArrays||""!==d?!isNaN(g)&&b!==d&&String(g)===d&&0<=g&&u.parseArrays&&g<=u.arrayLimit?(y=[])[g]=s:"__proto__"!==d&&(y[d]=s):y={0:s}),s=y}return s}},u=function normalizeParseOptions(e){if(!e)return y;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=(void 0===e.charset?y:e).charset;return{allowDots:void 0===e.allowDots?y.allowDots:!!e.allowDots,allowPrototypes:("boolean"==typeof e.allowPrototypes?e:y).allowPrototypes,allowSparse:("boolean"==typeof e.allowSparse?e:y).allowSparse,arrayLimit:("number"==typeof e.arrayLimit?e:y).arrayLimit,charset:t,charsetSentinel:("boolean"==typeof e.charsetSentinel?e:y).charsetSentinel,comma:("boolean"==typeof e.comma?e:y).comma,decoder:("function"==typeof e.decoder?e:y).decoder,delimiter:("string"==typeof e.delimiter||s.isRegExp(e.delimiter)?e:y).delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:y.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:("boolean"==typeof e.interpretNumericEntities?e:y).interpretNumericEntities,parameterLimit:("number"==typeof e.parameterLimit?e:y).parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:("boolean"==typeof e.plainObjects?e:y).plainObjects,strictNullHandling:("boolean"==typeof e.strictNullHandling?e:y).strictNullHandling}};t.exports=function(e,t){var r=u(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var o="string"==typeof e?c(e,r):e,n=r.plainObjects?Object.create(null):{},i=Object.keys(o),a=0;a<i.length;++a)var l=i[a],l=p(l,o[l],r,"string"==typeof e),n=s.merge(n,l,r);return!0===r.allowSparse?n:s.compact(n)}},{"./utils":19}],18:[function(e,t,r){"use strict";function C3(e,t){o.apply(e,I(t)?t:[t])}var k=e("side-channel"),R=e("./utils"),i=e("./formats"),a=Object.prototype.hasOwnProperty,s={brackets:function brackets(e){return e+"[]"},comma:"comma",indices:function indices(e,t){return e+"["+t+"]"},repeat:function repeat(e){return e}},I=Array.isArray,o=Array.prototype.push,n=Date.prototype.toISOString,e=i.default,B={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:R.encode,encodeValuesOnly:!1,format:e,formatter:i.formatters[e],indices:!1,serializeDate:function serializeDate(e){return n.call(e)},skipNulls:!1,strictNullHandling:!1},M=function isNonNullishPrimitive(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"symbol"==typeof e||"bigint"==typeof e},F={},f=function stringify(e,t,r,o,n,i,a,l,c,p,u,s,f,y,d,g){for(var b=e,h=g,m=0,v=!1;void 0!==(h=h.get(F))&&!v;){var S=h.get(e);if(m+=1,void 0!==S){if(S===m)throw new RangeError("Cyclic object value");v=!0}void 0===h.get(F)&&(m=0)}if("function"==typeof l?b=l(t,b):b instanceof Date?b=u(b):"comma"===r&&I(b)&&(b=R.maybeMap(b,function(e){return e instanceof Date?u(e):e})),null===b){if(n)return a&&!y?a(t,B.encoder,d,"key",s):t;b=""}if(M(b)||R.isBuffer(b))return a?[f(y?t:a(t,B.encoder,d,"key",s))+"="+f(a(b,B.encoder,d,"value",s))]:[f(t)+"="+f(String(b))];var w=[];if(void 0!==b)for(var j="comma"===r&&I(b)?[{value:0<(b=y&&a?R.maybeMap(b,a):b).length?b.join(",")||null:void 0}]:I(l)?l:(O=Object.keys(b),c?O.sort(c):O),O,j,P=o&&I(b)&&1===b.length?t+"[]":t,A=0;A<j.length;++A){var x,E=j[A],_="object"==typeof E&&void 0!==E.value?E.value:b[E];i&&null===_||(E=I(b)?"function"==typeof r?r(P,E):P:P+(p?"."+E:"["+E+"]"),g.set(e,m),(x=k()).set(F,g),C3(w,stringify(_,E,r,o,n,i,"comma"===r&&y&&I(b)?null:a,l,c,p,u,s,f,y,d,x)))}return w},y=function normalizeStringifyOptions(e){if(!e)return B;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||B.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=i.default;if(void 0!==e.format){if(!a.call(i.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var o=i.formatters[r],n=B.filter;return"function"!=typeof e.filter&&!I(e.filter)||(n=e.filter),{addQueryPrefix:("boolean"==typeof e.addQueryPrefix?e:B).addQueryPrefix,allowDots:void 0===e.allowDots?B.allowDots:!!e.allowDots,charset:t,charsetSentinel:("boolean"==typeof e.charsetSentinel?e:B).charsetSentinel,delimiter:(void 0===e.delimiter?B:e).delimiter,encode:("boolean"==typeof e.encode?e:B).encode,encoder:("function"==typeof e.encoder?e:B).encoder,encodeValuesOnly:("boolean"==typeof e.encodeValuesOnly?e:B).encodeValuesOnly,filter:n,format:r,formatter:o,serializeDate:("function"==typeof e.serializeDate?e:B).serializeDate,skipNulls:("boolean"==typeof e.skipNulls?e:B).skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:("boolean"==typeof e.strictNullHandling?e:B).strictNullHandling}};t.exports=function(e,t){var r=e,o=y(t),n=("function"==typeof o.filter?r=(0,o.filter)("",r):I(o.filter)&&(l=o.filter),[]);if("object"!=typeof r||null===r)return"";var e=t&&t.arrayFormat in s?t.arrayFormat:!(t&&"indices"in t)||t.indices?"indices":"repeat",i=s[e];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a="comma"===i&&t&&t.commaRoundTrip,l=l||Object.keys(r);o.sort&&l.sort(o.sort);for(var c=k(),p=0;p<l.length;++p){var u=l[p];o.skipNulls&&null===r[u]||C3(n,f(r[u],u,i,a,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}e=n.join(o.delimiter),t=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&("iso-8859-1"===o.charset?t+="utf8=%26%2310003%3B&":t+="utf8=%E2%9C%93&"),0<e.length?t+e:""}},{"./formats":15,"./utils":19,"side-channel":21}],19:[function(e,t,r){"use strict";var p=e("./formats"),a=Object.prototype.hasOwnProperty,l=Array.isArray,u=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function compactQueue(e){for(;1<e.length;){var t=e.pop(),r=t.obj[t.prop];if(l(r)){for(var o=[],n=0;n<r.length;++n)void 0!==r[n]&&o.push(r[n]);t.obj[t.prop]=o}}},c=function arrayToObject(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},o=0;o<e.length;++o)void 0!==e[o]&&(r[o]=e[o]);return r};t.exports={arrayToObject:c,assign:function assignSingleSource(e,r){return Object.keys(r).reduce(function(e,t){return e[t]=r[t],e},e)},combine:function combine(e,t){return[].concat(e,t)},compact:function compact(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],o=0;o<t.length;++o)for(var n=t[o],i=n.obj[n.prop],a=Object.keys(i),l=0;l<a.length;++l){var c=a[l],p=i[c];"object"==typeof p&&null!==p&&-1===r.indexOf(p)&&(t.push({obj:i,prop:c}),r.push(p))}return s(t),e},decode:function(t,e,r){t=t.replace(/\+/g," ");if("iso-8859-1"===r)return t.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(t)}catch(e){return t}},encode:function encode(e,t,r,o,n){if(0===e.length)return e;var i=e;if("symbol"==typeof e?i=Symbol.prototype.toString.call(e):"string"!=typeof e&&(i=String(e)),"iso-8859-1"===r)return escape(i).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var a="",l=0;l<i.length;++l){var c=i.charCodeAt(l);45===c||46===c||95===c||126===c||48<=c&&c<=57||65<=c&&c<=90||97<=c&&c<=122||n===p.RFC1738&&(40===c||41===c)?a+=i.charAt(l):c<128?a+=u[c]:c<2048?a+=u[192|c>>6]+u[128|63&c]:c<55296||57344<=c?a+=u[224|c>>12]+u[128|c>>6&63]+u[128|63&c]:(l+=1,c=65536+((1023&c)<<10|1023&i.charCodeAt(l)),a+=u[240|c>>18]+u[128|c>>12&63]+u[128|c>>6&63]+u[128|63&c])}return a},isBuffer:function isBuffer(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function isRegExp(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function maybeMap(e,t){if(l(e)){for(var r=[],o=0;o<e.length;o+=1)r.push(t(e[o]));return r}return t(e)},merge:function merge(o,n,i){if(!n)return o;if("object"!=typeof n){if(l(o))o.push(n);else{if(!o||"object"!=typeof o)return[o,n];(i&&(i.plainObjects||i.allowPrototypes)||!a.call(Object.prototype,n))&&(o[n]=!0)}return o}var e;return o&&"object"==typeof o?(l(e=o)&&!l(n)&&(e=c(o,i)),l(o)&&l(n)?(n.forEach(function(e,t){var r;a.call(o,t)?(r=o[t])&&"object"==typeof r&&e&&"object"==typeof e?o[t]=merge(r,e,i):o.push(e):o[t]=e}),o):Object.keys(n).reduce(function(e,t){var r=n[t];return a.call(e,t)?e[t]=merge(e[t],r,i):e[t]=r,e},e)):[o].concat(n)}}},{"./formats":15}],20:[function(e,t,r){"use strict";var o=e("get-intrinsic"),a=e("define-data-property"),l=e("has-property-descriptors")(),c=e("gopd"),p=o("%TypeError%"),u=o("%Math.floor%");t.exports=function setFunctionLength(e,t){if("function"!=typeof e)throw new p("`fn` is not a function");if("number"!=typeof t||t<0||4294967295<t||u(t)!==t)throw new p("`length` must be a positive 32-bit integer");var r,o=2<arguments.length&&!!arguments[2],n=!0,i=!0;return"length"in e&&c&&((r=c(e,"length"))&&!r.configurable&&(n=!1),r)&&!r.writable&&(i=!1),!n&&!i&&o||(l?a(e,"length",t,!0,!0):a(e,"length",t)),e}},{"define-data-property":4,"get-intrinsic":7,gopd:8,"has-property-descriptors":9}],21:[function(e,t,r){"use strict";function Pf(e,t){for(var r,o=e;null!==(r=o.next);o=r)if(r.key===t)return o.next=r.next,r.next=e.next,e.next=r}var o=e("get-intrinsic"),n=e("call-bind/callBound"),l=e("object-inspect"),c=o("%TypeError%"),p=o("%WeakMap%",!0),u=o("%Map%",!0),s=n("WeakMap.prototype.get",!0),f=n("WeakMap.prototype.set",!0),y=n("WeakMap.prototype.has",!0),d=n("Map.prototype.get",!0),g=n("Map.prototype.set",!0),b=n("Map.prototype.has",!0);t.exports=function getSideChannel(){var n,i,a,t={assert:function(e){if(!t.has(e))throw new c("Side channel does not contain "+l(e))},get:function(e){if(p&&e&&("object"==typeof e||"function"==typeof e)){if(n)return s(n,e)}else if(u){if(i)return d(i,e)}else{var t;if(a)return(t=Pf(t=a,e))&&t.value}},has:function(e){if(p&&e&&("object"==typeof e||"function"==typeof e)){if(n)return y(n,e)}else if(u){if(i)return b(i,e)}else if(a)return!!Pf(a,e);return!1},set:function(e,t){var r,o;p&&e&&("object"==typeof e||"function"==typeof e)?(n=n||new p,f(n,e,t)):u?(i=i||new u,g(i,e,t)):(t=t,(o=Pf(r=a=a||{key:{},next:null},e=e))?o.value=t:r.next={key:e,next:r.next,value:t})}};return t}},{"call-bind/callBound":2,"get-intrinsic":7,"object-inspect":14}],22:[function(e,t,r){t.exports={name:"google-script",version:"1.0.0",license:"MIT",author:{name:"Jeconias Santos",url:"https://github.com/Jeconias"},scripts:{start:"nodemon --ignore src/server --ignore src/types --watch src/ --ext .ts,.js --exec yarn build","start:server":"ts-node ./src/server","start:server:watch":"WITHOUT_NGROK=true nodemon --watch src --ext .ts,.js --exec ts-node ./src/server",build:"node ./cli build"},devDependencies:{"@babel/core":"^7.17.5","@babel/preset-typescript":"^7.16.7","@types/express":"^4.17.13","@types/google-apps-script":"^1.0.45","@types/lodash":"^4.14.179","@types/node":"^17.0.21",babelify:"^10.0.0",browserify:"^17.0.0",chalk:"^4.1.2",commander:"^9.1.0",dotenv:"^16.0.0",express:"^4.17.3",ngrok:"^4.3.1",nodemon:"^3.0.1",qs:"^6.10.3","ts-node":"^10.7.0",tsify:"^5.0.4",typescript:"^4.6.2","uglify-js":"^3.15.3"}}},{}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=e("../helpers/logger"),n=e("qs"),i=e("../helpers/utils");r.default=class HttpManager{static get(e,t,r){return"string"!=typeof t?{code:void 0,error:'"path" should be a string.'}:(e=""+e+(0,i.replaceParamsByValues)(t,null!=(e=null==r?void 0:r.urlParams)?e:{})+(0,n.stringify)(null!=(t=null==r?void 0:r.queryString)?t:{},{addQueryPrefix:!0}),o.logger.info("Requesting: "+e),200===(t=UrlFetchApp.fetch(e,{contentType:"application/json",muteHttpExceptions:!0,headers:null==r?void 0:r.headers})).getResponseCode()?(o.logger.info(`Request: ${e} -> Finished with HTTP code 200`),{code:200,data:JSON.parse(t.getContentText())}):(o.logger.err(`Request: ${e} -> Finished with HTTP code `+t.getResponseCode(),t.getContentText()),{code:t.getResponseCode(),error:t.getContentText()}))}}},{"../helpers/logger":25,"../helpers/utils":27,qs:16}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=e("../helpers/logger");r.default=class Service{constructor({base_url:e,writablePages:t}){this.base_url=e,this.writablePages=null!=t?t:[]}getBaseURL(){return this.base_url}getWritablePages(){return this.writablePages}getPageRef(e){var t;return this.writablePages.length?(e=null!=e?e:this.writablePages[0],o.logger.debug("Trying to get page reference with the name: "+e),(t=SpreadsheetApp.getActive().getSheetByName(e))||o.logger.err(`Page reference with the name ${e} is empty`),t):(o.logger.info('"writablePages" is empty.'),null)}}},{"../helpers/logger":25}],25:[function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.logger=void 0;const n=o(e("./packageInfo"));r.logger={debug:(...e)=>console.log(`[${n.default.name}][Debug]`,...e),info:(...e)=>console.log(`[${n.default.name}][Info]`,...e),err:(...e)=>console.error(`[${n.default.name}][Error]`,e)}},{"./packageInfo":26}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});e=e("../../package.json");r.default=e},{"../../package.json":22}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.replaceParamsByValues=void 0;r.replaceParamsByValues=(e,t)=>{const r="object"!=typeof t||Array.isArray(t)?{}:t;t=Object.keys(r);let o=e;return t.forEach(e=>{o=o.replace(":"+e,r[e])}),o}},{}],28:[function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.WritableSheetsPages=void 0;const n=o(e("../../core/HttpManager"));var o=o(e("../../core/Service")),i=r.WritableSheetsPages||(r.WritableSheetsPages={});i.BOOK="Books";class Book extends o.default{constructor(){super({base_url:"https://gutendex.com",writablePages:[i.BOOK]})}list(){return n.default.get(this.getBaseURL(),"/:example",{urlParams:{example:"books"},queryString:{languages:"en,fr,br"}})}}r.default=Book},{"../../core/HttpManager":23,"../../core/Service":24}],29:[function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});const l=e("../../helpers/logger"),c=a(e("../../helpers/packageInfo")),p=i(e("./Books"));r.default=function default_1(){return{info:()=>{SpreadsheetApp.getActiveSpreadsheet().toast("Version: "+c.default.version,""+c.default.name.toUpperCase())},books:()=>{var e,t=new p.default,r=t.list();r.error?l.logger.err("Error on request the list of the Books."):(t=t.getPageRef(p.WritableSheetsPages.BOOK),l.logger.info("Prepare data to write."),e=(r=null!=(r=null==(r=r.data)?void 0:r.results)?r:[]).map(e=>[e.id,e.title]),null!=t&&t.getRange(1,1,t.getMaxRows(),t.getMaxColumns()).clearContent(),null!=t&&t.getRange(1,1,null==r?void 0:r.length,2).setValues([...e]),l.logger.info("Finished."))}}}},{"../../helpers/logger":25,"../../helpers/packageInfo":26,"./Books":28}]},{},[29])(29)});